FROM node:20-alpine

ENV NPM_CONFIG_UPDATE_NOTIFIER=false
ENV NPM_CONFIG_FUND=false

WORKDIR /app

COPY . .

WORKDIR /app/Shared
RUN npm install && npm run build

WORKDIR /app/Offline
RUN npm install && npm run build

WORKDIR /app/Online/
RUN npm install && npm run build

RUN chmod +x /app/setupGame.sh

ARG PORT=3000
ENV PORT=${PORT}
EXPOSE ${PORT}

CMD ["/app/setupGame.sh"]