# ------------------------------------------------------------------------
# 1. BLOCK SENSITIVE INFRASTRUCTURE FILES (CRITICAL)
# ------------------------------------------------------------------------
# Blocks access to .env, .git, docker files, etc.
SecRule REQUEST_URI "@rx ^/(\.git|\.env|docker-compose\.yml|package\.json|node_modules)" \
    "id:10010,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Blocked access to sensitive file'"

# ------------------------------------------------------------------------
# 2. BLOCK METRICS ENDPOINT
# ------------------------------------------------------------------------
# Internal metrics should not be public.
SecRule REQUEST_URI "@beginsWith /metrics" \
    "id:10011,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Blocked access to Metrics'"

# ------------------------------------------------------------------------
# 3. BLOCK AUTOMATED TOOLS (Optional - For Production)
# ------------------------------------------------------------------------
# Blocks curl, wget, python scripts.
# COMMENT THIS OUT IF YOU ARE STILL TESTING WITH CURL.
# SecRule REQUEST_HEADERS:User-Agent "@pm curl wget python-requests go-http-client" \
#     "id:10012,\
#     phase:1,\
#     deny,\
#     status:403,\
#     msg:'Blocked Automated Client'"